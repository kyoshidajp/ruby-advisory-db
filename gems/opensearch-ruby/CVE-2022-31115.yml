---
gem: opensearch-ruby
cve: 2022-31115
ghsa: 977c-63xq-cgw3
url: https://github.com/opensearch-project/opensearch-ruby/security/advisories/GHSA-977c-63xq-cgw3
title: Unsafe YAML deserialization in opensearch-ruby
date: 2022-07-05
description: |
  ### Impact
  A YAML deserialization in opensearch-ruby 2.0.0 can lead to unsafe deserialization using YAML.load if the response is of type YAML.

  ### Patches
  The problem has been patched in opensearch-ruby gem version 2.0.2.

  ### Workarounds
  No viable workaround.  Please upgrade to 2.0.2

  ### References
  https://github.com/opensearch-project/opensearch-ruby/pull/77
  https://staaldraad.github.io/post/2021-01-09-universal-rce-ruby-yaml-load-updated/

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [opensearch-ruby](https://github.com/opensearch-project/opensearch-ruby)
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-977c-63xq-cgw3
- type: CVE
  value: CVE-2022-31115
summary: Unsafe YAML deserialization in opensearch-ruby
description: |
  ### Impact
  A YAML deserialization in opensearch-ruby 2.0.0 can lead to unsafe deserialization using YAML.load if the response is of type YAML.

  ### Patches
  The problem has been patched in opensearch-ruby gem version 2.0.2.

  ### Workarounds
  No viable workaround.  Please upgrade to 2.0.2

  ### References
  https://github.com/opensearch-project/opensearch-ruby/pull/77
  https://staaldraad.github.io/post/2021-01-09-universal-rce-ruby-yaml-load-updated/

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [opensearch-ruby](https://github.com/opensearch-project/opensearch-ruby)
severity: MODERATE
cvss:
  score: 0.0
  vectorString: 
references:
- url: https://github.com/opensearch-project/opensearch-ruby/security/advisories/GHSA-977c-63xq-cgw3
- url: https://nvd.nist.gov/vuln/detail/CVE-2022-31115
- url: https://github.com/opensearch-project/opensearch-ruby/pull/77
- url: https://staaldraad.github.io/post/2021-01-09-universal-rce-ruby-yaml-load-updated/
- url: https://github.com/advisories/GHSA-977c-63xq-cgw3
publishedAt: '2022-07-05T20:41:26Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: opensearch-ruby
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 2.0.2"
  firstPatchedVersion:
    identifier: 2.0.2

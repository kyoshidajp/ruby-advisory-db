---
gem: actionpack
cve: 2023-22792
ghsa: p84v-45xj-wwqj
url: https://github.com/rails/rails/releases/tag/v7.0.4.1
title: ReDoS based DoS vulnerability in Action Dispatch
date: 2023-01-18
description: |
  There is a possible regular expression based DoS vulnerability in Action Dispatch. This vulnerability has been assigned the CVE identifier CVE-2023-22792.

  Versions Affected: >= 3.0.0 Not affected: < 3.0.0 Fixed Versions: 6.1.7.1, 7.0.4.1
  Impact

  Specially crafted cookies, in combination with a specially crafted X_FORWARDED_HOST header can cause the regular expression engine to enter a state of catastrophic backtracking. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability All users running an affected release should either upgrade or use one of the workarounds immediately.
  Releases

  The FIXED releases are available at the normal locations.
  Workarounds

  We recommend that all users upgrade to one of the FIXED versions. In the meantime, users can mitigate this vulnerability by using a load balancer or other device to filter out malicious X_FORWARDED_HOST headers before they reach the application.
  Patches

  To aid users who aren’t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.

      6-1-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 6.1 series
      7-0-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 7.0 series

  Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-p84v-45xj-wwqj
- type: CVE
  value: CVE-2023-22792
summary: ReDoS based DoS vulnerability in Action Dispatch
description: |
  There is a possible regular expression based DoS vulnerability in Action Dispatch. This vulnerability has been assigned the CVE identifier CVE-2023-22792.

  Versions Affected: >= 3.0.0 Not affected: < 3.0.0 Fixed Versions: 6.1.7.1, 7.0.4.1
  Impact

  Specially crafted cookies, in combination with a specially crafted X_FORWARDED_HOST header can cause the regular expression engine to enter a state of catastrophic backtracking. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability All users running an affected release should either upgrade or use one of the workarounds immediately.
  Releases

  The FIXED releases are available at the normal locations.
  Workarounds

  We recommend that all users upgrade to one of the FIXED versions. In the meantime, users can mitigate this vulnerability by using a load balancer or other device to filter out malicious X_FORWARDED_HOST headers before they reach the application.
  Patches

  To aid users who aren’t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.

      6-1-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 6.1 series
      7-0-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 7.0 series

  Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.
severity: LOW
cvss:
  score: 0.0
  vectorString: 
references:
- url: https://github.com/rails/rails/releases/tag/v7.0.4.1
- url: https://github.com/advisories/GHSA-p84v-45xj-wwqj
publishedAt: '2023-01-18T18:23:34Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: actionpack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 3.0.0, < 6.1.7.1"
  firstPatchedVersion:
    identifier: 6.1.7.1

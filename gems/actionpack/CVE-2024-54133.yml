---
gem: actionpack
cve: 2024-54133
ghsa: vfm5-rmrh-j26v
url: https://github.com/rails/rails/security/advisories/GHSA-vfm5-rmrh-j26v
title: Possible Content Security Policy bypass in Action Dispatch
date: 2024-12-10
description: |
  There is a possible Cross Site Scripting (XSS) vulnerability  in the `content_security_policy` helper in Action Pack.

  Impact
  ------
  Applications which set Content-Security-Policy (CSP) headers dynamically from untrusted user input may be vulnerable to carefully crafted inputs being able to inject new directives into the CSP. This could lead to a bypass of the CSP and its protection against XSS and other attacks.

  Releases
  --------
  The fixed releases are available at the normal locations.

  Workarounds
  -----------
  Applications can avoid setting CSP headers dynamically from untrusted input, or can validate/sanitize that input.

  Credits
  -------
  Thanks to [ryotak](https://hackerone.com/ryotak) for the report!
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-vfm5-rmrh-j26v
- type: CVE
  value: CVE-2024-54133
summary: Possible Content Security Policy bypass in Action Dispatch
description: |
  There is a possible Cross Site Scripting (XSS) vulnerability  in the `content_security_policy` helper in Action Pack.

  Impact
  ------
  Applications which set Content-Security-Policy (CSP) headers dynamically from untrusted user input may be vulnerable to carefully crafted inputs being able to inject new directives into the CSP. This could lead to a bypass of the CSP and its protection against XSS and other attacks.

  Releases
  --------
  The fixed releases are available at the normal locations.

  Workarounds
  -----------
  Applications can avoid setting CSP headers dynamically from untrusted input, or can validate/sanitize that input.

  Credits
  -------
  Thanks to [ryotak](https://hackerone.com/ryotak) for the report!
severity: LOW
cvss:
  score: 0.0
  vectorString: 
references:
- url: https://github.com/rails/rails/security/advisories/GHSA-vfm5-rmrh-j26v
- url: https://github.com/advisories/GHSA-vfm5-rmrh-j26v
publishedAt: '2024-12-10T22:42:27Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: actionpack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 8.0.0, < 8.0.0.1"
  firstPatchedVersion:
    identifier: 8.0.0.1
- package:
    name: actionpack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 7.2.0, < 7.2.2.1"
  firstPatchedVersion:
    identifier: 7.2.2.1
- package:
    name: actionpack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 7.1.0, < 7.1.5.1"
  firstPatchedVersion:
    identifier: 7.1.5.1
- package:
    name: actionpack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 5.2.0, < 7.0.8.7"
  firstPatchedVersion:
    identifier: 7.0.8.7

---
gem: actionpack
cve: 2023-28362
ghsa: 4g8v-vg43-wpgf
url: https://github.com/rails/rails/commit/1c3f93d1e90a3475f9ae2377ead25ccf11f71441
title: Actionpack has possible cross-site scripting vulnerability via User Supplied
  Values to redirect_to
date: 2023-06-29
description: |
  The `redirect_to` method in Rails allows provided values to contain characters which are not legal in an HTTP header value. This results in the potential for downstream services which enforce RFC compliance on HTTP response headers to remove the assigned Location header. This vulnerability has been assigned the CVE identifier CVE-2023-28362.

  Versions Affected: All. Not affected: None Fixed Versions: 7.0.5.1, 6.1.7.4

  # Impact

  This introduces the potential for a Cross-site-scripting (XSS) payload to be delivered on the now static redirection page. Note that this both requires user interaction and for a Rails app to be configured to allow redirects to external hosts (defaults to false in Rails >= 7.0.x).

  # Releases

  The FIXED releases are available at the normal locations.

  # Workarounds

  Avoid providing user supplied URLs with arbitrary schemes to the `redirect_to` method.
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-4g8v-vg43-wpgf
- type: CVE
  value: CVE-2023-28362
summary: Actionpack has possible cross-site scripting vulnerability via User Supplied
  Values to redirect_to
description: |
  The `redirect_to` method in Rails allows provided values to contain characters which are not legal in an HTTP header value. This results in the potential for downstream services which enforce RFC compliance on HTTP response headers to remove the assigned Location header. This vulnerability has been assigned the CVE identifier CVE-2023-28362.

  Versions Affected: All. Not affected: None Fixed Versions: 7.0.5.1, 6.1.7.4

  # Impact

  This introduces the potential for a Cross-site-scripting (XSS) payload to be delivered on the now static redirection page. Note that this both requires user interaction and for a Rails app to be configured to allow redirects to external hosts (defaults to false in Rails >= 7.0.x).

  # Releases

  The FIXED releases are available at the normal locations.

  # Workarounds

  Avoid providing user supplied URLs with arbitrary schemes to the `redirect_to` method.
severity: MODERATE
cvss:
  score: 0.0
  vectorString: 
references:
- url: https://github.com/rails/rails/commit/1c3f93d1e90a3475f9ae2377ead25ccf11f71441
- url: https://github.com/rails/rails/commit/c9ab9b32bcdcfd8bcd55907f6c7b20b4e004cc23
- url: https://discuss.rubyonrails.org/t/cve-2023-28362-possible-xss-via-user-supplied-values-to-redirect-to/83132
- url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2023-28362.yml
- url: https://github.com/advisories/GHSA-4g8v-vg43-wpgf
publishedAt: '2023-06-29T15:03:16Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: actionpack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 7.0.0, < 7.0.5.1"
  firstPatchedVersion:
    identifier: 7.0.5.1
- package:
    name: actionpack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 6.1.7.4"
  firstPatchedVersion:
    identifier: 6.1.7.4

---
gem: doorkeeper
cve: 2023-34246
ghsa: 7w2c-w47h-789w
url: https://github.com/doorkeeper-gem/doorkeeper/security/advisories/GHSA-7w2c-w47h-789w
title: Doorkeeper Improper Authentication vulnerability
date: 2023-06-12
description: |-
  OAuth RFC 8252 says  https://www.rfc-editor.org/rfc/rfc8252#section-8.6

  > the authorization server SHOULD NOT process authorization requests automatically without user consent or interaction, except when the identity of the client can be assured. **This includes the case where the user has previously approved an authorization request for a given client id**

  But Doorkeeper automatically processes authorization requests without user consent for public clients that have been previous approved. Public clients are inherently vulnerable to impersonation, their identity cannot be assured.

  Issue https://github.com/doorkeeper-gem/doorkeeper/issues/1589

  Fix https://github.com/doorkeeper-gem/doorkeeper/pull/1646
cvss_v3: 4.2
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-7w2c-w47h-789w
- type: CVE
  value: CVE-2023-34246
summary: Doorkeeper Improper Authentication vulnerability
description: |-
  OAuth RFC 8252 says  https://www.rfc-editor.org/rfc/rfc8252#section-8.6

  > the authorization server SHOULD NOT process authorization requests automatically without user consent or interaction, except when the identity of the client can be assured. **This includes the case where the user has previously approved an authorization request for a given client id**

  But Doorkeeper automatically processes authorization requests without user consent for public clients that have been previous approved. Public clients are inherently vulnerable to impersonation, their identity cannot be assured.

  Issue https://github.com/doorkeeper-gem/doorkeeper/issues/1589

  Fix https://github.com/doorkeeper-gem/doorkeeper/pull/1646
severity: MODERATE
cvss:
  score: 4.2
  vectorString: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N
references:
- url: https://github.com/doorkeeper-gem/doorkeeper/security/advisories/GHSA-7w2c-w47h-789w
- url: https://nvd.nist.gov/vuln/detail/CVE-2023-34246
- url: https://github.com/doorkeeper-gem/doorkeeper/issues/1589
- url: https://github.com/doorkeeper-gem/doorkeeper/pull/1646
- url: https://github.com/doorkeeper-gem/doorkeeper/releases/tag/v5.6.6
- url: https://www.rfc-editor.org/rfc/rfc8252#section-8.6
- url: https://github.com/advisories/GHSA-7w2c-w47h-789w
publishedAt: '2023-06-12T19:50:34Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: doorkeeper
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 5.6.6"
  firstPatchedVersion:
    identifier: 5.6.6

---
gem: mapbox-rails
cve: 2017-1000042
ghsa: qr28-7j6p-9hmv
url: https://hackerone.com/reports/54327
title: Content Injection via TileJSON attribute in mapbox.js
date: 2018-11-09
description: |-
  Versions 1.x prior to 1.6.5 and 2.x prior to 2.1.7 of `mapbox.js` are vulnerable to a cross-site-scripting attack in certain uncommon usage scenarios.

  If `L.mapbox.map` or `L.mapbox.tileLayer` are used to load untrusted TileJSON content from a non-Mapbox URL, it is possible for a malicious user with control over the TileJSON content to inject script content into the "attribution" value of the TileJSON which will be executed in the context of the page using Mapbox.js.



  ## Recommendation

  Version 2.x: Update to version 2.1.7 or later.
  Version 1.x: Update to version 1.6.5 or later.
cvss_v3: 6.1
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-qr28-7j6p-9hmv
- type: CVE
  value: CVE-2017-1000042
summary: Content Injection via TileJSON attribute in mapbox.js
description: |-
  Versions 1.x prior to 1.6.5 and 2.x prior to 2.1.7 of `mapbox.js` are vulnerable to a cross-site-scripting attack in certain uncommon usage scenarios.

  If `L.mapbox.map` or `L.mapbox.tileLayer` are used to load untrusted TileJSON content from a non-Mapbox URL, it is possible for a malicious user with control over the TileJSON content to inject script content into the "attribution" value of the TileJSON which will be executed in the context of the page using Mapbox.js.



  ## Recommendation

  Version 2.x: Update to version 2.1.7 or later.
  Version 1.x: Update to version 1.6.5 or later.
severity: MODERATE
cvss:
  score: 6.1
  vectorString: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2017-1000042
- url: https://hackerone.com/reports/54327
- url: https://github.com/advisories/GHSA-qr28-7j6p-9hmv
- url: https://www.npmjs.com/advisories/49
- url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/mapbox-rails/CVE-2017-1000042.yml
- url: https://nodesecurity.io/advisories/49
publishedAt: '2018-11-09T17:47:45Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: mapbox-rails
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 2.0.0, < 2.1.7"
  firstPatchedVersion:
    identifier: 2.1.7
- package:
    name: mapbox-rails
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 1.0.0, < 1.6.5"
  firstPatchedVersion:
    identifier: 1.6.5

---
gem: mapbox-rails
cve: 2017-1000043
ghsa: q69p-5h74-w36f
url: https://hackerone.com/reports/99245
title: Content Injection via TileJSON Name in mapbox.js
date: 2018-11-09
description: |-
  Versions 1.x prior to 1.6.6 and 2.x prior to 2.2.4 of `mapbox.js` are vulnerable to a cross-site-scripting attack in certain uncommon usage scenarios.

  If `L.mapbox.map` or `L.mapbox.shareControl` are used in a manner that gives users control of the TileJSON content, it is possible to inject script content into the name value of the TileJSON. After clicking on the share control, the malicious code will execute in the context of the page using Mapbox.js.



  ## Recommendation

  Version 1.x: Update to version 1.6.6 or later.
  Version 2.x: Update to version 2.2.4 or later.
cvss_v3: 6.1
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-q69p-5h74-w36f
- type: CVE
  value: CVE-2017-1000043
summary: Content Injection via TileJSON Name in mapbox.js
description: |-
  Versions 1.x prior to 1.6.6 and 2.x prior to 2.2.4 of `mapbox.js` are vulnerable to a cross-site-scripting attack in certain uncommon usage scenarios.

  If `L.mapbox.map` or `L.mapbox.shareControl` are used in a manner that gives users control of the TileJSON content, it is possible to inject script content into the name value of the TileJSON. After clicking on the share control, the malicious code will execute in the context of the page using Mapbox.js.



  ## Recommendation

  Version 1.x: Update to version 1.6.6 or later.
  Version 2.x: Update to version 2.2.4 or later.
severity: MODERATE
cvss:
  score: 6.1
  vectorString: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2017-1000043
- url: https://hackerone.com/reports/99245
- url: https://github.com/advisories/GHSA-q69p-5h74-w36f
- url: https://www.npmjs.com/advisories/74
- url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/mapbox-rails/CVE-2017-1000043.yml
- url: https://nodesecurity.io/advisories/74
publishedAt: '2018-11-09T17:48:34Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: mapbox-rails
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 2.0.0, < 2.2.4"
  firstPatchedVersion:
    identifier: 2.2.4
- package:
    name: mapbox-rails
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 1.0.0, < 1.6.6"
  firstPatchedVersion:
    identifier: 1.6.6

---
gem: uri
cve: 2023-36617
ghsa: hww2-5g85-429m
url: https://github.com/ruby/uri/commit/3cd938df20db26c9439e9f681aadfb9bbeb6d1c0
title: URI gem has ReDoS vulnerability
date: 2023-06-29
description: |-
  A ReDoS issue was discovered in the URI component before 0.12.2 for Ruby. The URI parser mishandles invalid URLs that have specific characters. There is an increase in execution time for parsing strings to URI objects with `rfc2396_parser.rb` and `rfc3986_parser.rb`.

  NOTE: this issue exists becuse of an incomplete fix for CVE-2023-28755. Version 0.10.3 is also a fixed version.

  [The Ruby advisory recommends](https://www.ruby-lang.org/en/news/2023/06/29/redos-in-uri-CVE-2023-36617/) updating the uri gem to 0.12.2. In order to ensure compatibility with the bundled version in older Ruby series, you may update as follows instead:
  - For Ruby 3.0: Update to uri 0.10.3
  - For Ruby 3.1 and 3.2: Update to uri 0.12.2.

  You can use gem update uri to update it. If you are using bundler, please add gem `uri`, `>= 0.12.2` (or other version mentioned above) to your Gemfile.
cvss_v3: 5.3
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-hww2-5g85-429m
- type: CVE
  value: CVE-2023-36617
summary: URI gem has ReDoS vulnerability
description: |-
  A ReDoS issue was discovered in the URI component before 0.12.2 for Ruby. The URI parser mishandles invalid URLs that have specific characters. There is an increase in execution time for parsing strings to URI objects with `rfc2396_parser.rb` and `rfc3986_parser.rb`.

  NOTE: this issue exists becuse of an incomplete fix for CVE-2023-28755. Version 0.10.3 is also a fixed version.

  [The Ruby advisory recommends](https://www.ruby-lang.org/en/news/2023/06/29/redos-in-uri-CVE-2023-36617/) updating the uri gem to 0.12.2. In order to ensure compatibility with the bundled version in older Ruby series, you may update as follows instead:
  - For Ruby 3.0: Update to uri 0.10.3
  - For Ruby 3.1 and 3.2: Update to uri 0.12.2.

  You can use gem update uri to update it. If you are using bundler, please add gem `uri`, `>= 0.12.2` (or other version mentioned above) to your Gemfile.
severity: MODERATE
cvss:
  score: 5.3
  vectorString: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2023-36617
- url: https://github.com/ruby/uri/commit/3cd938df20db26c9439e9f681aadfb9bbeb6d1c0
- url: https://github.com/ruby/uri/commit/4d02315181d8a485496f1bb107a6ab51d6f3a35f
- url: https://github.com/ruby/uri/commit/7e33934c91b7f8f3ea7b7a4258b468e19f636bc3
- url: https://github.com/ruby/uri/commit/ba36c8a3ecad8c16dd3e60a6da9abd768206c8fa
- url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/uri/CVE-2023-36617.yml
- url: https://www.ruby-lang.org/en/news/2023/06/29/redos-in-uri-CVE-2023-36617
- url: https://github.com/advisories/GHSA-hww2-5g85-429m
publishedAt: '2023-06-29T15:30:34Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: uri
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 0.11.0, < 0.12.2"
  firstPatchedVersion:
    identifier: 0.12.2
- package:
    name: uri
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 0.10.3"
  firstPatchedVersion:
    identifier: 0.10.3

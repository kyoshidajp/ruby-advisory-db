---
gem: arr-pm
cve: 2022-39224
ghsa: 88cv-mj24-8w3q
url: https://github.com/jordansissel/ruby-arr-pm/security/advisories/GHSA-88cv-mj24-8w3q
title: arr-pm vulnerable to arbitrary shell execution when extracting or listing files
  contained in a malicious rpm.
date: 2022-09-21
description: |+
  ### Impact

  Arbitrary shell execution is possible when using RPM::File#files and RPM::File#extract if the RPM contains a malicious "payload compressor" field.

  This vulnerability impacts the `extract` and `files` methods of the `RPM::File` class in the affected versions of this library.

  ### Patches

  Version 0.0.12 is available with a fix for these issues.

  ### Workarounds

  When using an affected version of this library (arr-pm), ensure any RPMs being processed contain valid/known payload compressor values. Such values include: gzip, bzip2, xz, zstd, and lzma.

  You can check the payload compressor field in an rpm by using the rpm command line tool. For example:

  ```
  % rpm -qp example-1.0-1.x86_64.rpm --qf "%{PAYLOADCOMPRESSOR}\n"
  gzip
  ```

  ### Impact on known dependent projects

  This library is used by [fpm](https://github.com/jordansissel/fpm). The vulnerability may impact fpm only when using the flag `-s rpm` or `--input-type rpm` to convert a malicious rpm to another format. It does not impact creating rpms.

  ### References

  * https://github.com/jordansissel/ruby-arr-pm/pull/14
  * https://github.com/jordansissel/ruby-arr-pm/pull/15

  ### Credit

  Thanks to @joernchen for reporting this problem and contributing to the resolution :)

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [the arr-pm issue tracker](https://github.com/jordansissel/ruby-arr-pm/)

cvss_v3: 7.0
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-88cv-mj24-8w3q
- type: CVE
  value: CVE-2022-39224
summary: arr-pm vulnerable to arbitrary shell execution when extracting or listing
  files contained in a malicious rpm.
description: |+
  ### Impact

  Arbitrary shell execution is possible when using RPM::File#files and RPM::File#extract if the RPM contains a malicious "payload compressor" field.

  This vulnerability impacts the `extract` and `files` methods of the `RPM::File` class in the affected versions of this library.

  ### Patches

  Version 0.0.12 is available with a fix for these issues.

  ### Workarounds

  When using an affected version of this library (arr-pm), ensure any RPMs being processed contain valid/known payload compressor values. Such values include: gzip, bzip2, xz, zstd, and lzma.

  You can check the payload compressor field in an rpm by using the rpm command line tool. For example:

  ```
  % rpm -qp example-1.0-1.x86_64.rpm --qf "%{PAYLOADCOMPRESSOR}\n"
  gzip
  ```

  ### Impact on known dependent projects

  This library is used by [fpm](https://github.com/jordansissel/fpm). The vulnerability may impact fpm only when using the flag `-s rpm` or `--input-type rpm` to convert a malicious rpm to another format. It does not impact creating rpms.

  ### References

  * https://github.com/jordansissel/ruby-arr-pm/pull/14
  * https://github.com/jordansissel/ruby-arr-pm/pull/15

  ### Credit

  Thanks to @joernchen for reporting this problem and contributing to the resolution :)

  ### For more information

  If you have any questions or comments about this advisory:
  * Open an issue in [the arr-pm issue tracker](https://github.com/jordansissel/ruby-arr-pm/)

severity: HIGH
cvss:
  score: 7.0
  vectorString: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
references:
- url: https://github.com/jordansissel/ruby-arr-pm/security/advisories/GHSA-88cv-mj24-8w3q
- url: https://github.com/jordansissel/ruby-arr-pm/pull/14
- url: https://github.com/jordansissel/ruby-arr-pm/pull/15
- url: https://github.com/advisories/GHSA-88cv-mj24-8w3q
publishedAt: '2022-09-21T17:00:12Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: arr-pm
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 0.0.12"
  firstPatchedVersion:
    identifier: 0.0.12

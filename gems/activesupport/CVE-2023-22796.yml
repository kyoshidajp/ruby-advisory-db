---
gem: activesupport
cve: 2023-22796
ghsa: j6gc-792m-qgm2
url: https://github.com/rails/rails/releases/tag/v7.0.4.1
title: ReDoS based DoS vulnerability in Active Support’s underscore
date: 2023-01-18
description: |-
  There is a possible regular expression based DoS vulnerability in Active Support. This vulnerability has been assigned the CVE identifier CVE-2023-22796.

  Versions Affected: All Not affected: None Fixed Versions: 6.1.7.1, 7.0.4.1
  Impact

  A specially crafted string passed to the underscore method can cause the regular expression engine to enter a state of catastrophic backtracking. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability.

  This affects String#underscore, ActiveSupport::Inflector.underscore, String#titleize, and any other methods using these.

  All users running an affected release should either upgrade or use one of the workarounds immediately.
  Releases

  The FIXED releases are available at the normal locations.
  Workarounds

  There are no feasible workarounds for this issue.

  Users on Ruby 3.2.0 or greater may be able to reduce the impact by configuring Regexp.timeout.
  Patches

  To aid users who aren’t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.

      6-1-Avoid-regex-backtracking-in-Inflector.underscore.patch - Patch for 6.1 series
      7-0-Avoid-regex-backtracking-in-Inflector.underscore.patch - Patch for 7.0 series

  Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-j6gc-792m-qgm2
- type: CVE
  value: CVE-2023-22796
summary: ReDoS based DoS vulnerability in Active Support’s underscore
description: |-
  There is a possible regular expression based DoS vulnerability in Active Support. This vulnerability has been assigned the CVE identifier CVE-2023-22796.

  Versions Affected: All Not affected: None Fixed Versions: 6.1.7.1, 7.0.4.1
  Impact

  A specially crafted string passed to the underscore method can cause the regular expression engine to enter a state of catastrophic backtracking. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability.

  This affects String#underscore, ActiveSupport::Inflector.underscore, String#titleize, and any other methods using these.

  All users running an affected release should either upgrade or use one of the workarounds immediately.
  Releases

  The FIXED releases are available at the normal locations.
  Workarounds

  There are no feasible workarounds for this issue.

  Users on Ruby 3.2.0 or greater may be able to reduce the impact by configuring Regexp.timeout.
  Patches

  To aid users who aren’t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.

      6-1-Avoid-regex-backtracking-in-Inflector.underscore.patch - Patch for 6.1 series
      7-0-Avoid-regex-backtracking-in-Inflector.underscore.patch - Patch for 7.0 series

  Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.
severity: LOW
cvss:
  score: 0.0
  vectorString: 
references:
- url: https://github.com/rails/rails/releases/tag/v7.0.4.1
- url: https://github.com/advisories/GHSA-j6gc-792m-qgm2
publishedAt: '2023-01-18T18:23:20Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: activesupport
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 7.0.0, < 7.0.4.1"
  firstPatchedVersion:
    identifier: 7.0.4.1
- package:
    name: activesupport
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 6.1.7.1"
  firstPatchedVersion:
    identifier: 6.1.7.1

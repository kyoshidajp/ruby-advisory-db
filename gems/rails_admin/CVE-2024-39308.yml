---
gem: rails_admin
cve: 2024-39308
ghsa: 8qgm-g2vv-vwvc
url: https://github.com/railsadminteam/rails_admin/security/advisories/GHSA-8qgm-g2vv-vwvc
title: RailsAdmin Cross-site Scripting vulnerability in the list view
date: 2024-07-08
description: |-
  ### Impact
  RailsAdmin list view has the XSS vulnerability, caused by improperly-escaped HTML title attribute.
  The issue was originally reported in https://github.com/railsadminteam/rails_admin/issues/3686.

  ### Patches
  Upgrade to [3.1.3](https://rubygems.org/gems/rails_admin/versions/3.1.3) or [2.3.0](https://rubygems.org/gems/rails_admin/versions/2.3.0).

  ### Workarounds
  1. Copy the index view (located under the path `app/views/rails_admin/main/index.html.erb`) from the RailsAdmin version you use, and place it into your application by using the same path.
  2. Open the view file by an editor, and remove `strip_tags` from the title attribute:

  ```diff
                 <% properties.map{ |property| property.bind(:object, object) }.each do |property| %>
                   <% value = property.pretty_value %>
  -                <td class="<%= [property.sticky? && 'sticky', property.css_class, property.type_css_class].select(&:present?).join(' ') %>" title="<%= strip_tags(value.to_s) %>">
  +                <td class="<%= [property.sticky? && 'sticky', property.css_class, property.type_css_class].select(&:present?).join(' ') %>" title="<%= value %>">
                     <%= value %>
                   </td>
                 <% end %>
  ```

  **Note:** The view file created by this needs to be removed after upgrading RailsAdmin afterwards, unless this old view continue to be used. Only do this if you can't upgrade RailsAdmin now for a reason.

  ### References
  https://owasp.org/www-community/attacks/xss/
  https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-strip_tags
cvss_v3: 6.8
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-8qgm-g2vv-vwvc
- type: CVE
  value: CVE-2024-39308
summary: RailsAdmin Cross-site Scripting vulnerability in the list view
description: |-
  ### Impact
  RailsAdmin list view has the XSS vulnerability, caused by improperly-escaped HTML title attribute.
  The issue was originally reported in https://github.com/railsadminteam/rails_admin/issues/3686.

  ### Patches
  Upgrade to [3.1.3](https://rubygems.org/gems/rails_admin/versions/3.1.3) or [2.3.0](https://rubygems.org/gems/rails_admin/versions/2.3.0).

  ### Workarounds
  1. Copy the index view (located under the path `app/views/rails_admin/main/index.html.erb`) from the RailsAdmin version you use, and place it into your application by using the same path.
  2. Open the view file by an editor, and remove `strip_tags` from the title attribute:

  ```diff
                 <% properties.map{ |property| property.bind(:object, object) }.each do |property| %>
                   <% value = property.pretty_value %>
  -                <td class="<%= [property.sticky? && 'sticky', property.css_class, property.type_css_class].select(&:present?).join(' ') %>" title="<%= strip_tags(value.to_s) %>">
  +                <td class="<%= [property.sticky? && 'sticky', property.css_class, property.type_css_class].select(&:present?).join(' ') %>" title="<%= value %>">
                     <%= value %>
                   </td>
                 <% end %>
  ```

  **Note:** The view file created by this needs to be removed after upgrading RailsAdmin afterwards, unless this old view continue to be used. Only do this if you can't upgrade RailsAdmin now for a reason.

  ### References
  https://owasp.org/www-community/attacks/xss/
  https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-strip_tags
severity: MODERATE
cvss:
  score: 6.8
  vectorString: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N
references:
- url: https://github.com/railsadminteam/rails_admin/security/advisories/GHSA-8qgm-g2vv-vwvc
- url: https://github.com/railsadminteam/rails_admin/issues/3686
- url: https://github.com/railsadminteam/rails_admin/commit/b5a287d82e2cbd1737a1a01e11ede2911cce7fef
- url: https://github.com/railsadminteam/rails_admin/commit/d84b39884059c4ed50197cec8522cca029a17673
- url: https://rubygems.org/gems/rails_admin/versions/2.3.0
- url: https://rubygems.org/gems/rails_admin/versions/3.1.3
- url: https://nvd.nist.gov/vuln/detail/CVE-2024-39308
- url: https://github.com/advisories/GHSA-8qgm-g2vv-vwvc
publishedAt: '2024-07-08T14:14:43Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: rails_admin
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 2.3.0"
  firstPatchedVersion:
    identifier: 2.3.0
- package:
    name: rails_admin
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 3.0.0, < 3.1.3"
  firstPatchedVersion:
    identifier: 3.1.3

---
gem: rack
cve: 2023-27530
ghsa: 3h57-hmj3-gj3p
url: https://discuss.rubyonrails.org/t/cve-2023-27530-possible-dos-vulnerability-in-multipart-mime-parsing/82388
title: Rack has possible DoS Vulnerability in Multipart MIME parsing
date: 2023-03-08
description: |
  There is a possible DoS vulnerability in the Multipart MIME parsing code in Rack. This vulnerability has been assigned the CVE identifier CVE-2023-27530.

  Versions Affected: All. Not affected: None Fixed Versions: 3.0.4.2, 2.2.6.3, 2.1.4.3, 2.0.9.3

  # Impact
  The Multipart MIME parsing code in Rack limits the number of file parts, but does not limit the total number of parts that can be uploaded. Carefully crafted requests can abuse this and cause multipart parsing to take longer than expected.

  All users running an affected release should either upgrade or use one of the workarounds immediately.

  # Workarounds
  A proxy can be configured to limit the POST body size which will mitigate this issue.
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-3h57-hmj3-gj3p
- type: CVE
  value: CVE-2023-27530
summary: Rack has possible DoS Vulnerability in Multipart MIME parsing
description: |
  There is a possible DoS vulnerability in the Multipart MIME parsing code in Rack. This vulnerability has been assigned the CVE identifier CVE-2023-27530.

  Versions Affected: All. Not affected: None Fixed Versions: 3.0.4.2, 2.2.6.3, 2.1.4.3, 2.0.9.3

  # Impact
  The Multipart MIME parsing code in Rack limits the number of file parts, but does not limit the total number of parts that can be uploaded. Carefully crafted requests can abuse this and cause multipart parsing to take longer than expected.

  All users running an affected release should either upgrade or use one of the workarounds immediately.

  # Workarounds
  A proxy can be configured to limit the POST body size which will mitigate this issue.
severity: HIGH
cvss:
  score: 0.0
  vectorString: 
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2023-27530
- url: https://discuss.rubyonrails.org/t/cve-2023-27530-possible-dos-vulnerability-in-multipart-mime-parsing/82388
- url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2023-27530.yml
- url: https://github.com/advisories/GHSA-3h57-hmj3-gj3p
publishedAt: '2023-03-08T17:20:04Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: rack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 3.0.0, < 3.0.4.2"
  firstPatchedVersion:
    identifier: 3.0.4.2
- package:
    name: rack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 2.2.0, < 2.2.6.3"
  firstPatchedVersion:
    identifier: 2.2.6.3
- package:
    name: rack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 2.1.0, < 2.1.4.3"
  firstPatchedVersion:
    identifier: 2.1.4.3
- package:
    name: rack
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 2.0.9.3"
  firstPatchedVersion:
    identifier: 2.0.9.3

---
gem: nokogiri
cve: 2022-23476
ghsa: qv4q-mr5r-qprj
url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-qv4q-mr5r-qprj
title: Unchecked return value from xmlTextReaderExpand
date: 2022-12-08
description: "## Summary\n\nNokogiri `1.13.8, 1.13.9` fails to check the return value
  from `xmlTextReaderExpand` in the method `Nokogiri::XML::Reader#attribute_hash`.
  This can lead to a null pointer exception when invalid markup is being parsed. \n\nFor
  applications using `XML::Reader` to parse untrusted inputs, this may potentially
  be a vector for a denial of service attack.\n\n\n## Mitigation\n\nUpgrade to Nokogiri
  `>= 1.13.10`.\n\nUsers may be able to search their code for calls to either `XML::Reader#attributes`
  or `XML::Reader#attribute_hash` to determine if they are affected.\n\n\n## Severity\n\nThe
  Nokogiri maintainers have evaluated this as [High Severity 7.5 (CVSS3.1)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n\n\n##
  References\n\n- [CWE - CWE-252: Unchecked Return Value (4.9)](https://cwe.mitre.org/data/definitions/252.html)\n-
  [CWE - CWE-476: NULL Pointer Dereference (4.9)](https://cwe.mitre.org/data/definitions/476.html)\n\n\n##
  Credit\n\nThis vulnerability was responsibly reported by @davidwilemski.\n"
cvss_v3: 7.5
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-qv4q-mr5r-qprj
- type: CVE
  value: CVE-2022-23476
summary: Unchecked return value from xmlTextReaderExpand
description: "## Summary\n\nNokogiri `1.13.8, 1.13.9` fails to check the return value
  from `xmlTextReaderExpand` in the method `Nokogiri::XML::Reader#attribute_hash`.
  This can lead to a null pointer exception when invalid markup is being parsed. \n\nFor
  applications using `XML::Reader` to parse untrusted inputs, this may potentially
  be a vector for a denial of service attack.\n\n\n## Mitigation\n\nUpgrade to Nokogiri
  `>= 1.13.10`.\n\nUsers may be able to search their code for calls to either `XML::Reader#attributes`
  or `XML::Reader#attribute_hash` to determine if they are affected.\n\n\n## Severity\n\nThe
  Nokogiri maintainers have evaluated this as [High Severity 7.5 (CVSS3.1)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H).\n\n\n##
  References\n\n- [CWE - CWE-252: Unchecked Return Value (4.9)](https://cwe.mitre.org/data/definitions/252.html)\n-
  [CWE - CWE-476: NULL Pointer Dereference (4.9)](https://cwe.mitre.org/data/definitions/476.html)\n\n\n##
  Credit\n\nThis vulnerability was responsibly reported by @davidwilemski.\n"
severity: HIGH
cvss:
  score: 7.5
  vectorString: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
references:
- url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-qv4q-mr5r-qprj
- url: https://github.com/sparklemotion/nokogiri/commit/85410e38410f670cbbc8c5b00d07b843caee88ce
- url: https://github.com/sparklemotion/nokogiri/commit/9fe0761c47c0d4270d1a5220cfd25de080350d50
- url: https://github.com/advisories/GHSA-qv4q-mr5r-qprj
publishedAt: '2022-12-08T03:03:33Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: nokogiri
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 1.13.8, < 1.13.10"
  firstPatchedVersion:
    identifier: 1.13.10

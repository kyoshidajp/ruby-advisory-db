---
gem: nokogiri
cve: 2021-3517
ghsa: jw9f-hh49-cvp9
url: https://bugzilla.redhat.com/show_bug.cgi?id=1954232
title: Nokogiri contains libxml Out-of-bounds Write vulnerability
date: 2022-05-24
description: |-
  There is a flaw in the xml entity encoding functionality of libxml2 in versions before 2.9.11. An attacker who is able to supply a crafted file to be processed by an application linked with the affected functionality of libxml2 could trigger an out-of-bounds read. The most likely impact of this flaw is to application availability, with some potential impact to confidentiality and integrity if an attacker is able to use memory information to further exploit the application.

  Nokogiri prior to version 1.11.4 used a vulnerable version of libxml2. Nokogiri 1.11.4 updated libxml2 to version 2.9.11 to address this and other vulnerabilities in libxml2.
cvss_v3: 8.6
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-jw9f-hh49-cvp9
- type: CVE
  value: CVE-2021-3517
summary: Nokogiri contains libxml Out-of-bounds Write vulnerability
description: |-
  There is a flaw in the xml entity encoding functionality of libxml2 in versions before 2.9.11. An attacker who is able to supply a crafted file to be processed by an application linked with the affected functionality of libxml2 could trigger an out-of-bounds read. The most likely impact of this flaw is to application availability, with some potential impact to confidentiality and integrity if an attacker is able to use memory information to further exploit the application.

  Nokogiri prior to version 1.11.4 used a vulnerable version of libxml2. Nokogiri 1.11.4 updated libxml2 to version 2.9.11 to address this and other vulnerabilities in libxml2.
severity: HIGH
cvss:
  score: 8.6
  vectorString: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2021-3517
- url: https://bugzilla.redhat.com/show_bug.cgi?id=1954232
- url: https://lists.apache.org/thread.html/r58af02e294bd07f487e2c64ffc0a29b837db5600e33b6e698b9d696b@%3Cissues.bookkeeper.apache.org%3E
- url: https://lists.apache.org/thread.html/rf4c02775860db415b4955778a131c2795223f61cb8c6a450893651e4@%3Cissues.bookkeeper.apache.org%3E
- url: https://lists.debian.org/debian-lts-announce/2021/05/msg00008.html
- url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BZOMV5J4PMZAORVT64BKLV6YIZAFDGX6/
- url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QVM4UJ3376I6ZVOYMHBNX4GY3NIV52WV/
- url: https://security.gentoo.org/glsa/202107-05
- url: https://security.netapp.com/advisory/ntap-20210625-0002/
- url: https://security.netapp.com/advisory/ntap-20211022-0004/
- url: https://www.oracle.com/security-alerts/cpuapr2022.html
- url: https://www.oracle.com/security-alerts/cpujan2022.html
- url: https://www.oracle.com/security-alerts/cpuoct2021.html
- url: https://www.oracle.com/security-alerts/cpujul2022.html
- url: https://github.com/sparklemotion/nokogiri/issues/2233
- url: https://github.com/sparklemotion/nokogiri/issues/2274
- url: https://github.com/sparklemotion/nokogiri/blob/7c19ef5cc6b7c5c36827dd5495f857c6877ec8cf/CHANGELOG.md?plain=1#L579
- url: https://gitlab.gnome.org/GNOME/libxml2/-/commit/8598060bacada41a0eb09d95c97744ff4e428f8e
- url: https://github.com/advisories/GHSA-jw9f-hh49-cvp9
publishedAt: '2022-05-24T19:02:48Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: nokogiri
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 1.11.4"
  firstPatchedVersion:
    identifier: 1.11.4

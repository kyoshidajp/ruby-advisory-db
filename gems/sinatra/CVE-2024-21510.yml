---
gem: sinatra
cve: 2024-21510
ghsa: hxx2-7vcw-mqr3
url: https://github.com/sinatra/sinatra/pull/2010
title: Sinatra vulnerable to Reliance on Untrusted Inputs in a Security Decision
date: 2024-11-01
description: Versions of the package sinatra from 0.0.0 are vulnerable to Reliance
  on Untrusted Inputs in a Security Decision via the X-Forwarded-Host (XFH) header.
  When making a request to a method with redirect applied, it is possible to trigger
  an Open Redirect Attack by inserting an arbitrary address into this header. If used
  for caching purposes, such as with servers like Nginx, or as a reverse proxy, without
  handling the X-Forwarded-Host header, attackers can potentially exploit Cache Poisoning
  or Routing-based SSRF.
cvss_v3: 5.4
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-hxx2-7vcw-mqr3
- type: CVE
  value: CVE-2024-21510
summary: Sinatra vulnerable to Reliance on Untrusted Inputs in a Security Decision
description: Versions of the package sinatra from 0.0.0 are vulnerable to Reliance
  on Untrusted Inputs in a Security Decision via the X-Forwarded-Host (XFH) header.
  When making a request to a method with redirect applied, it is possible to trigger
  an Open Redirect Attack by inserting an arbitrary address into this header. If used
  for caching purposes, such as with servers like Nginx, or as a reverse proxy, without
  handling the X-Forwarded-Host header, attackers can potentially exploit Cache Poisoning
  or Routing-based SSRF.
severity: MODERATE
cvss:
  score: 5.4
  vectorString: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2024-21510
- url: https://github.com/sinatra/sinatra/pull/2010
- url: https://security.snyk.io/vuln/SNYK-RUBY-SINATRA-6483832
- url: https://github.com/sinatra/sinatra/blob/b626e2d82c23b4fde0b51782fd32ca27ccde1d1a/lib/sinatra/base.rb#L319
- url: https://github.com/sinatra/sinatra/blob/b626e2d82c23b4fde0b51782fd32ca27ccde1d1a/lib/sinatra/base.rb#L323C1-L343C17
- url: https://github.com/advisories/GHSA-hxx2-7vcw-mqr3
publishedAt: '2024-11-01T06:30:34Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: sinatra
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "<= 4.0.0"
  firstPatchedVersion: 

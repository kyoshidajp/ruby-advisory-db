---
gem: sinatra
cve: 2022-45442
ghsa: 2x8x-jmrp-phxw
url: https://github.com/sinatra/sinatra/security/advisories/GHSA-2x8x-jmrp-phxw
title: Sinatra vulnerable to Reflected File Download attack
date: 2022-11-30
description: "### Description\r\nAn issue was discovered in Sinatra 2.0 before 2.2.3
  and 3.0 before 3.0.4. An application is vulnerable to a reflected file download
  (RFD) attack that sets the Content-Disposition header of a response when the filename
  is derived from user-supplied input.\r\n\r\n### References\r\n* https://www.blackhat.com/docs/eu-14/materials/eu-14-Hafif-Reflected-File-Download-A-New-Web-Attack-Vector.pdf\r\n*
  https://github.com/advisories/GHSA-8x94-hmjh-97hq"
cvss_v3: 8.8
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-2x8x-jmrp-phxw
- type: CVE
  value: CVE-2022-45442
summary: Sinatra vulnerable to Reflected File Download attack
description: "### Description\r\nAn issue was discovered in Sinatra 2.0 before 2.2.3
  and 3.0 before 3.0.4. An application is vulnerable to a reflected file download
  (RFD) attack that sets the Content-Disposition header of a response when the filename
  is derived from user-supplied input.\r\n\r\n### References\r\n* https://www.blackhat.com/docs/eu-14/materials/eu-14-Hafif-Reflected-File-Download-A-New-Web-Attack-Vector.pdf\r\n*
  https://github.com/advisories/GHSA-8x94-hmjh-97hq"
severity: HIGH
cvss:
  score: 8.8
  vectorString: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
references:
- url: https://github.com/sinatra/sinatra/security/advisories/GHSA-2x8x-jmrp-phxw
- url: https://nvd.nist.gov/vuln/detail/CVE-2022-45442
- url: https://github.com/sinatra/sinatra/commit/ea8fc9495a350f7551b39e3025bfcd06f49f363b
- url: https://github.com/advisories/GHSA-8x94-hmjh-97hq
- url: https://www.blackhat.com/docs/eu-14/materials/eu-14-Hafif-Reflected-File-Download-A-New-Web-Attack-Vector.pdf
- url: https://github.com/advisories/GHSA-2x8x-jmrp-phxw
publishedAt: '2022-11-30T21:18:34Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: sinatra
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 2.2.3"
  firstPatchedVersion:
    identifier: 2.2.3
- package:
    name: sinatra
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 3.0, < 3.0.4"
  firstPatchedVersion:
    identifier: 3.0.4

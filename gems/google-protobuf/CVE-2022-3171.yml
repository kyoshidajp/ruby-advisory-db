---
gem: google-protobuf
cve: 2022-3171
ghsa: h4h5-3hr4-j3g2
url: https://github.com/protocolbuffers/protobuf/security/advisories/GHSA-h4h5-3hr4-j3g2
title: protobuf-java has a potential Denial of Service issue
date: 2022-10-04
description: "## Summary\nA potential Denial of Service issue in `protobuf-java` core
  and lite was discovered in the parsing procedure for binary and text format data.
  Input streams containing multiple instances of non-repeated [embedded messages](http://developers.google.com/protocol-buffers/docs/encoding#embedded)
  with repeated or unknown fields causes objects to be converted back-n-forth between
  mutable and immutable forms, resulting in potentially long garbage collection pauses.
  \n\nReporter: [OSS Fuzz](https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48771)\n\nAffected
  versions: This issue affects both the Java full and lite Protobuf runtimes, as well
  as Protobuf for Kotlin and JRuby, which themselves use the Java Protobuf runtime.\n\n##
  Severity\n\n[CVE-2022-3171](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3171)
  Medium - CVSS Score: 5.7 (NOTE: there may be a delay in publication)\n\n## Remediation
  and Mitigation\n\nPlease update to the latest available versions of the following
  packages:\n\nprotobuf-java (3.21.7, 3.20.3, 3.19.6, 3.16.3)\nprotobuf-javalite (3.21.7,
  3.20.3, 3.19.6, 3.16.3)\nprotobuf-kotlin (3.21.7, 3.20.3, 3.19.6, 3.16.3)\nprotobuf-kotlin-lite
  (3.21.7, 3.20.3, 3.19.6, 3.16.3)\ngoogle-protobuf [JRuby gem only] (3.21.7, 3.20.3,
  3.19.6)\n"
cvss_v3: 5.7
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-h4h5-3hr4-j3g2
- type: CVE
  value: CVE-2022-3171
summary: protobuf-java has a potential Denial of Service issue
description: "## Summary\nA potential Denial of Service issue in `protobuf-java` core
  and lite was discovered in the parsing procedure for binary and text format data.
  Input streams containing multiple instances of non-repeated [embedded messages](http://developers.google.com/protocol-buffers/docs/encoding#embedded)
  with repeated or unknown fields causes objects to be converted back-n-forth between
  mutable and immutable forms, resulting in potentially long garbage collection pauses.
  \n\nReporter: [OSS Fuzz](https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48771)\n\nAffected
  versions: This issue affects both the Java full and lite Protobuf runtimes, as well
  as Protobuf for Kotlin and JRuby, which themselves use the Java Protobuf runtime.\n\n##
  Severity\n\n[CVE-2022-3171](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3171)
  Medium - CVSS Score: 5.7 (NOTE: there may be a delay in publication)\n\n## Remediation
  and Mitigation\n\nPlease update to the latest available versions of the following
  packages:\n\nprotobuf-java (3.21.7, 3.20.3, 3.19.6, 3.16.3)\nprotobuf-javalite (3.21.7,
  3.20.3, 3.19.6, 3.16.3)\nprotobuf-kotlin (3.21.7, 3.20.3, 3.19.6, 3.16.3)\nprotobuf-kotlin-lite
  (3.21.7, 3.20.3, 3.19.6, 3.16.3)\ngoogle-protobuf [JRuby gem only] (3.21.7, 3.20.3,
  3.19.6)\n"
severity: MODERATE
cvss:
  score: 5.7
  vectorString: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
references:
- url: https://github.com/protocolbuffers/protobuf/security/advisories/GHSA-h4h5-3hr4-j3g2
- url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48771
- url: https://github.com/protocolbuffers/protobuf/releases/tag/v21.7
- url: https://github.com/protocolbuffers/protobuf/releases/tag/v3.16.3
- url: https://github.com/protocolbuffers/protobuf/releases/tag/v3.19.6
- url: https://github.com/protocolbuffers/protobuf/releases/tag/v3.20.3
- url: https://github.com/advisories/GHSA-h4h5-3hr4-j3g2
publishedAt: '2022-10-04T22:17:15Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: google-protobuf
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 3.16.3"
  firstPatchedVersion:
    identifier: 3.16.3
- package:
    name: google-protobuf
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 3.17.0.rc.1, < 3.19.6"
  firstPatchedVersion:
    identifier: 3.19.6
- package:
    name: google-protobuf
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 3.20.0.rc.1, < 3.20.3"
  firstPatchedVersion:
    identifier: 3.20.3
- package:
    name: google-protobuf
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 3.21.0.rc.1, < 3.21.7"
  firstPatchedVersion:
    identifier: 3.21.7

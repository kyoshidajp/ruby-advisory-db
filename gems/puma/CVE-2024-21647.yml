---
gem: puma
cve: 2024-21647
ghsa: c2f4-cvqm-65w2
url: https://github.com/puma/puma/security/advisories/GHSA-c2f4-cvqm-65w2
title: Puma HTTP Request/Response Smuggling vulnerability
date: 2024-01-08
description: |-
  ### Impact
  Prior to versions 6.4.2 and 5.6.8, puma exhibited incorrect behavior when parsing chunked transfer encoding bodies in a way that allowed HTTP request smuggling.

  Fixed versions limit the size of chunk extensions. Without this limit, an attacker could cause unbounded resource (CPU, network bandwidth) consumption.

  ### Patches

  The vulnerability has been fixed in 6.4.2 and 5.6.8.

  ### Workarounds

  No known workarounds.

  ### References

  * [HTTP Request Smuggling](https://portswigger.net/web-security/request-smuggling)
  * Open an issue in [Puma](https://github.com/puma/puma)
  * See our [security policy](https://github.com/puma/puma/security/policy)
cvss_v3: 5.9
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-c2f4-cvqm-65w2
- type: CVE
  value: CVE-2024-21647
summary: Puma HTTP Request/Response Smuggling vulnerability
description: |-
  ### Impact
  Prior to versions 6.4.2 and 5.6.8, puma exhibited incorrect behavior when parsing chunked transfer encoding bodies in a way that allowed HTTP request smuggling.

  Fixed versions limit the size of chunk extensions. Without this limit, an attacker could cause unbounded resource (CPU, network bandwidth) consumption.

  ### Patches

  The vulnerability has been fixed in 6.4.2 and 5.6.8.

  ### Workarounds

  No known workarounds.

  ### References

  * [HTTP Request Smuggling](https://portswigger.net/web-security/request-smuggling)
  * Open an issue in [Puma](https://github.com/puma/puma)
  * See our [security policy](https://github.com/puma/puma/security/policy)
severity: MODERATE
cvss:
  score: 5.9
  vectorString: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
references:
- url: https://github.com/puma/puma/security/advisories/GHSA-c2f4-cvqm-65w2
- url: https://nvd.nist.gov/vuln/detail/CVE-2024-21647
- url: https://github.com/puma/puma/commit/5fc43d73b6ff193325e657a24ed76dec79133e93
- url: https://github.com/puma/puma/commit/60d5ee3734adc8cee85c3f0561af392448fe19b7
- url: https://github.com/puma/puma/commit/bbb880ffb6debbfdea535b4b3eb2204d49ae151d
- url: https://github.com/advisories/GHSA-c2f4-cvqm-65w2
publishedAt: '2024-01-08T15:56:48Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: puma
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 5.6.8"
  firstPatchedVersion:
    identifier: 5.6.8
- package:
    name: puma
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 6.0.0, < 6.4.2"
  firstPatchedVersion:
    identifier: 6.4.2

---
gem: discordrb
cve: 2023-28102
ghsa: 8832-4mm5-x2r6
url: https://github.com/shardlab/discordrb/commit/91e13043ffa89227c3fcdc3408f06da237d28c95
title: discordrb OS Command Injection vulnerability
date: 2024-03-14
description: 'discordrb is an implementation of the Discord API using Ruby. In discordrb
  before commit `91e13043ffa` the `encoder.rb` file unsafely constructs a shell string
  using the file parameter, which can potentially leave clients of discordrb vulnerable
  to command injection. The library is not directly exploitable: the exploit requires
  that some client of the library calls the vulnerable method with user input. However,
  if unsafe input reaches the library method, then an attacker can execute arbitrary
  shell commands on the host machine. Full impact will depend on the permissions of
  the process running the `discordrb` library and will likely not be total system
  access. This issue has been addressed in code, but a new release of the `discordrb`
  gem has not been uploaded to rubygems. This issue is also tracked as `GHSL-2022-094`.'
cvss_v3: 9.6
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-8832-4mm5-x2r6
- type: CVE
  value: CVE-2023-28102
summary: discordrb OS Command Injection vulnerability
description: 'discordrb is an implementation of the Discord API using Ruby. In discordrb
  before commit `91e13043ffa` the `encoder.rb` file unsafely constructs a shell string
  using the file parameter, which can potentially leave clients of discordrb vulnerable
  to command injection. The library is not directly exploitable: the exploit requires
  that some client of the library calls the vulnerable method with user input. However,
  if unsafe input reaches the library method, then an attacker can execute arbitrary
  shell commands on the host machine. Full impact will depend on the permissions of
  the process running the `discordrb` library and will likely not be total system
  access. This issue has been addressed in code, but a new release of the `discordrb`
  gem has not been uploaded to rubygems. This issue is also tracked as `GHSL-2022-094`.'
severity: CRITICAL
cvss:
  score: 9.6
  vectorString: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2023-28102
- url: https://github.com/shardlab/discordrb/commit/91e13043ffa89227c3fcdc3408f06da237d28c95
- url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/discordrb/CVE-2023-28102.yml
- url: https://securitylab.github.com/advisories
- url: https://securitylab.github.com/advisories/GHSL-2022-094_discordrb
- url: https://github.com/advisories/GHSA-8832-4mm5-x2r6
publishedAt: '2024-03-14T20:37:58Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: discordrb
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 3.4.3"
  firstPatchedVersion:
    identifier: 3.4.3

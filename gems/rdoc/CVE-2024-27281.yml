---
gem: rdoc
cve: 2024-27281
ghsa: 592j-995h-p23j
url: https://github.com/ruby/rdoc/commit/1254b0066f312ddbf7fae7a195e66ce5b3bc6656
title: RDoc RCE vulnerability with .rdoc_options
date: 2024-03-25
description: |-
  An issue was discovered in RDoc 6.3.3 through 6.6.2, as distributed in Ruby 3.x through 3.3.0.

  When parsing `.rdoc_options` (used for configuration in RDoc) as a YAML file, object injection and resultant remote code execution are possible because there are no restrictions on the classes that can be restored.

  When loading the documentation cache, object injection and resultant remote code execution are also possible if there were a crafted cache.

  We recommend to update the RDoc gem to version 6.6.3.1 or later. In order to ensure compatibility with bundled version in older Ruby series, you may update as follows instead:

  * For Ruby 3.0 users: Update to `rdoc` 6.3.4.1
  * For Ruby 3.1 users: Update to `rdoc` 6.4.1.1
  * For Ruby 3.2 users: Update to `rdoc` 6.5.1.1

  You can use `gem update rdoc` to update it. If you are using bundler, please add `gem "rdoc", ">= 6.6.3.1"` to your `Gemfile`.

  Note: 6.3.4, 6.4.1, 6.5.1 and 6.6.3 have a incorrect fix. We recommend to upgrade 6.3.4.1, 6.4.1.1, 6.5.1.1 and 6.6.3.1 instead of them.
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-592j-995h-p23j
- type: CVE
  value: CVE-2024-27281
summary: RDoc RCE vulnerability with .rdoc_options
description: |-
  An issue was discovered in RDoc 6.3.3 through 6.6.2, as distributed in Ruby 3.x through 3.3.0.

  When parsing `.rdoc_options` (used for configuration in RDoc) as a YAML file, object injection and resultant remote code execution are possible because there are no restrictions on the classes that can be restored.

  When loading the documentation cache, object injection and resultant remote code execution are also possible if there were a crafted cache.

  We recommend to update the RDoc gem to version 6.6.3.1 or later. In order to ensure compatibility with bundled version in older Ruby series, you may update as follows instead:

  * For Ruby 3.0 users: Update to `rdoc` 6.3.4.1
  * For Ruby 3.1 users: Update to `rdoc` 6.4.1.1
  * For Ruby 3.2 users: Update to `rdoc` 6.5.1.1

  You can use `gem update rdoc` to update it. If you are using bundler, please add `gem "rdoc", ">= 6.6.3.1"` to your `Gemfile`.

  Note: 6.3.4, 6.4.1, 6.5.1 and 6.6.3 have a incorrect fix. We recommend to upgrade 6.3.4.1, 6.4.1.1, 6.5.1.1 and 6.6.3.1 instead of them.
severity: HIGH
cvss:
  score: 0.0
  vectorString: 
references:
- url: https://github.com/ruby/rdoc/commit/1254b0066f312ddbf7fae7a195e66ce5b3bc6656
- url: https://github.com/ruby/rdoc/commit/32ff6ba0bebd8ea26f569da5fd23be2937f6a644
- url: https://github.com/ruby/rdoc/commit/48617985e9fbc2825219d55f04e3e0e98d2923be
- url: https://github.com/ruby/rdoc/commit/811f125a4a0cc968e3eb18e16ea6c1a3b49a11bf
- url: https://github.com/ruby/rdoc/commit/a5de13bf0f0c26f8e764e82b5bf4bf8bffc7198e
- url: https://github.com/ruby/rdoc/commit/d22ba930f1f611dda531dba04cd3d2531bb3f8a5
- url: https://github.com/ruby/rdoc/commit/da7a0c7553ef7250ca665a3fecdc01dbaacbb43d
- url: https://github.com/ruby/rdoc/commit/e4a0e71e6f1032f8b4e5e58b4ef60d702c22ce17
- url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rdoc/CVE-2024-27281.yml
- url: https://www.ruby-lang.org/en/news/2024/03/21/rce-rdoc-cve-2024-27281
- url: https://github.com/advisories/GHSA-592j-995h-p23j
publishedAt: '2024-03-25T19:36:59Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: rdoc
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 6.6.0, < 6.6.3.1"
  firstPatchedVersion:
    identifier: 6.6.3.1
- package:
    name: rdoc
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 6.5.0, < 6.5.1.1"
  firstPatchedVersion:
    identifier: 6.5.1.1
- package:
    name: rdoc
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 6.4.0, < 6.4.1.1"
  firstPatchedVersion:
    identifier: 6.4.1.1
- package:
    name: rdoc
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 6.3.0, < 6.3.4.1"
  firstPatchedVersion:
    identifier: 6.3.4.1

---
gem: activerecord
cve: 2022-32224
ghsa: 3hhc-qp5v-9p2j
url: https://github.com/rails/rails/commit/611990f1a6c137c2d56b1ba06b27e5d2434dcd6a
title: RCE bug with Serialized Columns in Active Record
date: 2022-07-12
description: |-
  When serialized columns that use YAML (the default) are deserialized, Rails uses YAML.unsafe_load to convert the YAML data in to Ruby objects. If an attacker can manipulate data in the database (via means like SQL injection), then it may be possible for the attacker to escalate to an RCE.

  There are no feasible workarounds for this issue, but other coders (such as JSON) are not impacted.
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-3hhc-qp5v-9p2j
- type: CVE
  value: CVE-2022-32224
summary: RCE bug with Serialized Columns in Active Record
description: |-
  When serialized columns that use YAML (the default) are deserialized, Rails uses YAML.unsafe_load to convert the YAML data in to Ruby objects. If an attacker can manipulate data in the database (via means like SQL injection), then it may be possible for the attacker to escalate to an RCE.

  There are no feasible workarounds for this issue, but other coders (such as JSON) are not impacted.
severity: HIGH
cvss:
  score: 0.0
  vectorString: 
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2022-32224
- url: https://github.com/rails/rails/commit/611990f1a6c137c2d56b1ba06b27e5d2434dcd6a
- url: https://discuss.rubyonrails.org/t/cve-2022-32224-possible-rce-escalation-bug-with-serialized-columns-in-active-record/81017
- url: https://github.com/advisories/GHSA-3hhc-qp5v-9p2j
publishedAt: '2022-07-12T19:39:47Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: activerecord
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "<= 5.2.8"
  firstPatchedVersion:
    identifier: 5.2.8.1
- package:
    name: activerecord
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 6.0.0, <= 6.0.5"
  firstPatchedVersion:
    identifier: 6.0.5.1
- package:
    name: activerecord
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 6.1.0, <= 6.1.6"
  firstPatchedVersion:
    identifier: 6.1.6.1
- package:
    name: activerecord
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 7.0.0, <= 7.0.3"
  firstPatchedVersion:
    identifier: 7.0.3.1

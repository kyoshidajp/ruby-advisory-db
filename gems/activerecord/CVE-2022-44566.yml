---
gem: activerecord
cve: 2022-44566
ghsa: 579w-22j4-4749
url: https://github.com/rails/rails/releases/tag/v7.0.4.1
title: Denial of Service Vulnerability in ActiveRecord’s PostgreSQL adapter
date: 2023-01-18
description: |
  There is a potential denial of service vulnerability present in ActiveRecord’s PostgreSQL adapter.

  This has been assigned the CVE identifier CVE-2022-44566.

  Versions Affected: All. Not affected: None. Fixed Versions: 7.0.4.1, 6.1.7.1
  Impact

  In ActiveRecord <7.0.4.1 and <6.1.7.1, when a value outside the range for a 64bit signed integer is provided to the PostgreSQL connection adapter, it will treat the target column type as numeric. Comparing integer values against numeric values can result in a slow sequential scan resulting in potential Denial of Service.
  Releases

  The fixed releases are available at the normal locations.
  Workarounds

  Ensure that user supplied input which is provided to ActiveRecord clauses do not contain integers wider than a signed 64bit representation or floats.
  Patches

  To aid users who aren’t able to upgrade immediately we have provided patches for the supported release series in accordance with our maintenance policy 1 regarding security issues. They are in git-am format and consist of a single changeset.

      6-1-Added-integer-width-check-to-PostgreSQL-Quoting.patch - Patch for 6.1 series
      7-0-Added-integer-width-check-to-PostgreSQL-Quoting.patch - Patch for 7.0 series
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-579w-22j4-4749
- type: CVE
  value: CVE-2022-44566
summary: Denial of Service Vulnerability in ActiveRecord’s PostgreSQL adapter
description: |
  There is a potential denial of service vulnerability present in ActiveRecord’s PostgreSQL adapter.

  This has been assigned the CVE identifier CVE-2022-44566.

  Versions Affected: All. Not affected: None. Fixed Versions: 7.0.4.1, 6.1.7.1
  Impact

  In ActiveRecord <7.0.4.1 and <6.1.7.1, when a value outside the range for a 64bit signed integer is provided to the PostgreSQL connection adapter, it will treat the target column type as numeric. Comparing integer values against numeric values can result in a slow sequential scan resulting in potential Denial of Service.
  Releases

  The fixed releases are available at the normal locations.
  Workarounds

  Ensure that user supplied input which is provided to ActiveRecord clauses do not contain integers wider than a signed 64bit representation or floats.
  Patches

  To aid users who aren’t able to upgrade immediately we have provided patches for the supported release series in accordance with our maintenance policy 1 regarding security issues. They are in git-am format and consist of a single changeset.

      6-1-Added-integer-width-check-to-PostgreSQL-Quoting.patch - Patch for 6.1 series
      7-0-Added-integer-width-check-to-PostgreSQL-Quoting.patch - Patch for 7.0 series
severity: LOW
cvss:
  score: 0.0
  vectorString: 
references:
- url: https://github.com/rails/rails/releases/tag/v7.0.4.1
- url: https://github.com/advisories/GHSA-579w-22j4-4749
publishedAt: '2023-01-18T18:21:12Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: activerecord
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 7.0.0, < 7.0.4.1"
  firstPatchedVersion:
    identifier: 7.0.4.1
- package:
    name: activerecord
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 6.1.7.1"
  firstPatchedVersion:
    identifier: 6.1.7.1

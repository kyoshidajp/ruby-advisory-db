---
gem: fat_free_crm
cve: 2022-39281
ghsa: p75c-5x3h-cxcg
url: https://github.com/fatfreecrm/fat_free_crm/security/advisories/GHSA-p75c-5x3h-cxcg
title: Fat Free CRM vulnerable to Remote Denial of Service via Tasks endpoint
date: 2022-10-07
description: |+
  ### Impact
  An authenticated user can perform a remote Denial of Service attack against Fat Free CRM.

  This vulnerability has been assigned the CVE identifier: CVE-2022-39281

  Affected versions: All
  Not affected: None
  Fixed versions: 0.20.1

  All users running an affected release should either upgrade or apply the patch immediately.

  ### Releases
  Fixed versions: 0.20.1 and above

  ### Patches

  If you are unable to upgrade immediately, you should apply the following patch.

  ```
  diff --git a/app/models/polymorphic/task.rb b/app/models/polymorphic/task.rb
  index d3d5c32c..7cdb24d6 100644
  --- a/app/models/polymorphic/task.rb
  +++ b/app/models/polymorphic/task.rb
  @@ -189,6 +189,7 @@ class Task < ActiveRecord::Base
     #----------------------------------------------------------------------------
     def self.bucket_empty?(bucket, user, view = "pending")
       return false if bucket.blank? || !ALLOWED_VIEWS.include?(view)
  +    return false unless Setting.task_bucket.map(&:to_s).include?(bucket.to_s)

       if view == "assigned"
         assigned_by(user).send(bucket).pending.count
  ```

  ### Credits

  Thanks to @p- for reporting this and working with us to responsibly disclose this vulnerability.

  ### Further information
  If you have any questions or comments about this advisory, please Open an issue in [GitHub Issue Tracker](https://github.com/fatfreecrm/fat_free_crm/issues)

cvss_v3: 6.5
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-p75c-5x3h-cxcg
- type: CVE
  value: CVE-2022-39281
summary: Fat Free CRM vulnerable to Remote Denial of Service via Tasks endpoint
description: |+
  ### Impact
  An authenticated user can perform a remote Denial of Service attack against Fat Free CRM.

  This vulnerability has been assigned the CVE identifier: CVE-2022-39281

  Affected versions: All
  Not affected: None
  Fixed versions: 0.20.1

  All users running an affected release should either upgrade or apply the patch immediately.

  ### Releases
  Fixed versions: 0.20.1 and above

  ### Patches

  If you are unable to upgrade immediately, you should apply the following patch.

  ```
  diff --git a/app/models/polymorphic/task.rb b/app/models/polymorphic/task.rb
  index d3d5c32c..7cdb24d6 100644
  --- a/app/models/polymorphic/task.rb
  +++ b/app/models/polymorphic/task.rb
  @@ -189,6 +189,7 @@ class Task < ActiveRecord::Base
     #----------------------------------------------------------------------------
     def self.bucket_empty?(bucket, user, view = "pending")
       return false if bucket.blank? || !ALLOWED_VIEWS.include?(view)
  +    return false unless Setting.task_bucket.map(&:to_s).include?(bucket.to_s)

       if view == "assigned"
         assigned_by(user).send(bucket).pending.count
  ```

  ### Credits

  Thanks to @p- for reporting this and working with us to responsibly disclose this vulnerability.

  ### Further information
  If you have any questions or comments about this advisory, please Open an issue in [GitHub Issue Tracker](https://github.com/fatfreecrm/fat_free_crm/issues)

severity: MODERATE
cvss:
  score: 6.5
  vectorString: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
references:
- url: https://github.com/fatfreecrm/fat_free_crm/security/advisories/GHSA-p75c-5x3h-cxcg
- url: https://github.com/fatfreecrm/fat_free_crm/commit/c85a2546348c2692d32f952c753f7f0b43d1ca71
- url: https://github.com/fatfreecrm/fat_free_crm/releases/tag/v0.20.1
- url: https://github.com/advisories/GHSA-p75c-5x3h-cxcg
publishedAt: '2022-10-07T21:19:01Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: fat_free_crm
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 0.20.1"
  firstPatchedVersion:
    identifier: 0.20.1

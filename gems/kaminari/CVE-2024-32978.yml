---
gem: kaminari
cve: 2024-32978
ghsa: 7r3j-qmr4-jfpj
url: https://github.com/kaminari/kaminari/security/advisories/GHSA-7r3j-qmr4-jfpj
title: Kaminari Insecure File Permissions Vulnerability
date: 2024-05-28
description: "A moderate severity security vulnerability has been identified in the
  Kaminari pagination library for Ruby on Rails, concerning insecure file permissions.
  This advisory outlines the vulnerability, affected versions, and provides guidance
  for mitigation.\n\n### Impact\n\nThis vulnerability is of moderate severity due
  to the potential for unauthorized write access to particular Ruby files managed
  by the library. Such access could lead to the alteration of application behavior
  or data integrity issues.\n\n### Resolution\n\nThose who use the `gem install` command,
  such as `gem install kaminari -v 0.16.1`, `gem unpack kaminari -v 0.16.1`, or `bundle
  install` to download the package would **_not_** be affected and no action is required.
  \n\nThose who manually download and decompressing the affected versions are advised
  to update to 0.16.2 or later version of Kaminari where file permissions have been
  adjusted to enhance security.\n\n### Workarounds\n\nIf upgrading is not feasible
  immediately, manually adjusting the file permissions on the server to `644` to restrict
  access is a viable interim measure.\n\n#### All Affected Versions:\n\n```\nlib/kaminari/models/page_scope_methods.rb\n```\n\nIn
  addition to the previously mentioned files, security tools like AWS Inspector might
  also identify other files as unsafe. These files, although not loaded or used at
  runtime, may still be flagged. To avoid any potential confusion in your logs and
  ensure system integrity, we recommend updating the permissions for these files as
  well. This proactive measure helps maintain a clean security posture and minimizes
  unnecessary alerts.\n\n#### Version 0.15.0 and 0.15.1:\n\n```\nspec/models/mongo_mapper/mongo_mapper_spec.rb\n```\n\n####
  Version 0.16.0:\n\n```\nspec/models/mongo_mapper/mongo_mapper_spec.rb\nspec/models/mongoid/mongoid_spec.rb\n```\n\n####
  Version 0.16.1:\n\n```\nspec/models/active_record/scopes_spec.rb\nspec/models/mongo_mapper/mongo_mapper_spec.rb\nspec/models/mongoid/mongoid_spec.rb\ngemfiles/data_mapper_12.gemfile\ngemfiles/active_record_32.gemfile\n```\n\n###
  References\n\nOfficial Kaminari repository link (this page)\n\n### Acknowledgements\n\nWe
  thank [Gareth Jones](https://github.com/G-Rath) for discovering and reporting this
  issue. Their diligent work is instrumental in our ongoing efforts to maintain and
  improve software security."
cvss_v3: 6.6
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-7r3j-qmr4-jfpj
- type: CVE
  value: CVE-2024-32978
summary: Kaminari Insecure File Permissions Vulnerability
description: "A moderate severity security vulnerability has been identified in the
  Kaminari pagination library for Ruby on Rails, concerning insecure file permissions.
  This advisory outlines the vulnerability, affected versions, and provides guidance
  for mitigation.\n\n### Impact\n\nThis vulnerability is of moderate severity due
  to the potential for unauthorized write access to particular Ruby files managed
  by the library. Such access could lead to the alteration of application behavior
  or data integrity issues.\n\n### Resolution\n\nThose who use the `gem install` command,
  such as `gem install kaminari -v 0.16.1`, `gem unpack kaminari -v 0.16.1`, or `bundle
  install` to download the package would **_not_** be affected and no action is required.
  \n\nThose who manually download and decompressing the affected versions are advised
  to update to 0.16.2 or later version of Kaminari where file permissions have been
  adjusted to enhance security.\n\n### Workarounds\n\nIf upgrading is not feasible
  immediately, manually adjusting the file permissions on the server to `644` to restrict
  access is a viable interim measure.\n\n#### All Affected Versions:\n\n```\nlib/kaminari/models/page_scope_methods.rb\n```\n\nIn
  addition to the previously mentioned files, security tools like AWS Inspector might
  also identify other files as unsafe. These files, although not loaded or used at
  runtime, may still be flagged. To avoid any potential confusion in your logs and
  ensure system integrity, we recommend updating the permissions for these files as
  well. This proactive measure helps maintain a clean security posture and minimizes
  unnecessary alerts.\n\n#### Version 0.15.0 and 0.15.1:\n\n```\nspec/models/mongo_mapper/mongo_mapper_spec.rb\n```\n\n####
  Version 0.16.0:\n\n```\nspec/models/mongo_mapper/mongo_mapper_spec.rb\nspec/models/mongoid/mongoid_spec.rb\n```\n\n####
  Version 0.16.1:\n\n```\nspec/models/active_record/scopes_spec.rb\nspec/models/mongo_mapper/mongo_mapper_spec.rb\nspec/models/mongoid/mongoid_spec.rb\ngemfiles/data_mapper_12.gemfile\ngemfiles/active_record_32.gemfile\n```\n\n###
  References\n\nOfficial Kaminari repository link (this page)\n\n### Acknowledgements\n\nWe
  thank [Gareth Jones](https://github.com/G-Rath) for discovering and reporting this
  issue. Their diligent work is instrumental in our ongoing efforts to maintain and
  improve software security."
severity: MODERATE
cvss:
  score: 6.6
  vectorString: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
references:
- url: https://github.com/kaminari/kaminari/security/advisories/GHSA-7r3j-qmr4-jfpj
- url: https://nvd.nist.gov/vuln/detail/CVE-2024-32978
- url: https://github.com/advisories/GHSA-7r3j-qmr4-jfpj
publishedAt: '2024-05-28T15:47:00Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: kaminari
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 0.15.0, <= 0.16.1"
  firstPatchedVersion:
    identifier: 0.16.2

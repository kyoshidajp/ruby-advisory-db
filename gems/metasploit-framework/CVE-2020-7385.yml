---
gem: metasploit-framework
cve: 2020-7385
ghsa: xgww-h98f-24qf
url: https://github.com/rapid7/metasploit-framework/pull/14300
title: Metasploit Framework user exposes Metasploit to same deserialization issue
  that is exploited by that module
date: 2022-05-24
description: By launching the drb_remote_codeexec exploit, a Metasploit Framework
  user will inadvertently expose Metasploit to the same deserialization issue that
  is exploited by that module, due to the reliance on the vulnerable Distributed Ruby
  class functions. Since Metasploit Framework typically runs with elevated privileges,
  this can lead to a system compromise on the Metasploit workstation. Note that an
  attacker would have to lie in wait and entice the Metasploit user to run the affected
  module against a malicious endpoint in a "hack-back" type of attack. Metasploit
  is only vulnerable when the drb_remote_codeexec module is running. In most cases,
  this cannot happen automatically.
cvss_v3: 8.1
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-xgww-h98f-24qf
- type: CVE
  value: CVE-2020-7385
summary: Metasploit Framework user exposes Metasploit to same deserialization issue
  that is exploited by that module
description: By launching the drb_remote_codeexec exploit, a Metasploit Framework
  user will inadvertently expose Metasploit to the same deserialization issue that
  is exploited by that module, due to the reliance on the vulnerable Distributed Ruby
  class functions. Since Metasploit Framework typically runs with elevated privileges,
  this can lead to a system compromise on the Metasploit workstation. Note that an
  attacker would have to lie in wait and entice the Metasploit user to run the affected
  module against a malicious endpoint in a "hack-back" type of attack. Metasploit
  is only vulnerable when the drb_remote_codeexec module is running. In most cases,
  this cannot happen automatically.
severity: HIGH
cvss:
  score: 8.1
  vectorString: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
references:
- url: https://nvd.nist.gov/vuln/detail/CVE-2020-7385
- url: https://github.com/rapid7/metasploit-framework/pull/14300
- url: https://github.com/rapid7/metasploit-framework/pull/14335
- url: https://help.rapid7.com/metasploit/release-notes/archive/2020/10/
- url: https://github.com/advisories/GHSA-xgww-h98f-24qf
publishedAt: '2022-05-24T17:48:42Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: metasploit-framework
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 4.19.0"
  firstPatchedVersion:
    identifier: 4.19.0

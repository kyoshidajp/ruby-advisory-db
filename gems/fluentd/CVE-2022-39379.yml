---
gem: fluentd
cve: 2022-39379
ghsa: fppq-mj76-fpj2
url: https://github.com/fluent/fluentd/security/advisories/GHSA-fppq-mj76-fpj2
title: fluentd vulnerable to remote code execution due to insecure deserialization
  (in non-default configuration)
date: 2022-11-02
description: |
  ### Impact
  A remote code execution (RCE) vulnerability in non-default configurations of Fluentd  allows unauthenticated attackers to execute arbitrary code via specially crafted JSON payloads.

  Fluentd setups are only affected if the environment variable `FLUENT_OJ_OPTION_MODE` is explicitly set to `object`.

  Please note: The option FLUENT_OJ_OPTION_MODE was introduced in Fluentd version 1.13.2. Earlier versions of Fluentd are not affected by this vulnerability.

  ### Patches
  v1.15.3

  ### Workarounds
  Do not use `FLUENT_OJ_OPTION_MODE=object`.

  ### References

  * GHSL-2022-067
cvss_v3: 3.1
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-fppq-mj76-fpj2
- type: CVE
  value: CVE-2022-39379
summary: fluentd vulnerable to remote code execution due to insecure deserialization
  (in non-default configuration)
description: |
  ### Impact
  A remote code execution (RCE) vulnerability in non-default configurations of Fluentd  allows unauthenticated attackers to execute arbitrary code via specially crafted JSON payloads.

  Fluentd setups are only affected if the environment variable `FLUENT_OJ_OPTION_MODE` is explicitly set to `object`.

  Please note: The option FLUENT_OJ_OPTION_MODE was introduced in Fluentd version 1.13.2. Earlier versions of Fluentd are not affected by this vulnerability.

  ### Patches
  v1.15.3

  ### Workarounds
  Do not use `FLUENT_OJ_OPTION_MODE=object`.

  ### References

  * GHSL-2022-067
severity: LOW
cvss:
  score: 3.1
  vectorString: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
references:
- url: https://github.com/fluent/fluentd/security/advisories/GHSA-fppq-mj76-fpj2
- url: https://github.com/fluent/fluentd/commit/48e5b85dab1b6d4c273090d538fc11b3f2fd8135
- url: https://nvd.nist.gov/vuln/detail/CVE-2022-39379
- url: https://github.com/advisories/GHSA-fppq-mj76-fpj2
publishedAt: '2022-11-02T18:15:35Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: fluentd
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 1.13.2, < 1.15.3"
  firstPatchedVersion:
    identifier: 1.15.3

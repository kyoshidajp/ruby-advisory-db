---
gem: ruby-saml
cve: 2024-45409
ghsa: jw9c-mfg7-9rx2
url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-jw9c-mfg7-9rx2
title: SAML authentication bypass via Incorrect XPath selector
date: 2024-09-10
description: |-
  Ruby-SAML in <= 12.2 and 1.13.0 <= 1.16.0 does not properly verify the signature of the SAML Response. An unauthenticated attacker with access to any signed saml document (by the IdP) can thus forge a SAML Response/Assertion with arbitrary contents. This would allow the attacker to log in as arbitrary user within the vulnerable system.

  This vulnerability was reported by ahacker1 of SecureSAML (ahacker1@securesaml.com)
cvss_v3: 10.0
unaffected_versions:
- "<OPTIONAL: FILL IN SEE BELOW>"
patched_versions:
- "<FILL IN SEE BELOW>"


# GitHub advisory data below - **Remove this data before committing**
# Use this data to write patched_versions (and potentially unaffected_versions) above
---
identifiers:
- type: GHSA
  value: GHSA-jw9c-mfg7-9rx2
- type: CVE
  value: CVE-2024-45409
summary: SAML authentication bypass via Incorrect XPath selector
description: |-
  Ruby-SAML in <= 12.2 and 1.13.0 <= 1.16.0 does not properly verify the signature of the SAML Response. An unauthenticated attacker with access to any signed saml document (by the IdP) can thus forge a SAML Response/Assertion with arbitrary contents. This would allow the attacker to log in as arbitrary user within the vulnerable system.

  This vulnerability was reported by ahacker1 of SecureSAML (ahacker1@securesaml.com)
severity: CRITICAL
cvss:
  score: 10.0
  vectorString: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
references:
- url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-jw9c-mfg7-9rx2
- url: https://github.com/SAML-Toolkits/ruby-saml/commit/1ec5392bc506fe43a02dbb66b68741051c5ffeae
- url: https://github.com/SAML-Toolkits/ruby-saml/commit/4865d030cae9705ee5cdb12415c654c634093ae7
- url: https://nvd.nist.gov/vuln/detail/CVE-2024-45409
- url: https://github.com/advisories/GHSA-jw9c-mfg7-9rx2
publishedAt: '2024-09-10T19:42:03Z'
withdrawnAt: 
vulnerabilities:
- package:
    name: ruby-saml
    ecosystem: RUBYGEMS
  vulnerableVersionRange: ">= 1.13.0, < 1.17.0"
  firstPatchedVersion:
    identifier: 1.17.0
- package:
    name: ruby-saml
    ecosystem: RUBYGEMS
  vulnerableVersionRange: "< 1.12.3"
  firstPatchedVersion:
    identifier: 1.12.3
